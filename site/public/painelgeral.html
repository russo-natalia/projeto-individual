<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/estilo-geral.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <title>Abstract | Painel Geral</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="obterDadosGrafico(), obterDadosGrafico2(), obterDadosGrafico3(), obterDadosGrafico4(), obterDadosGrafico5(), obterDadosGrafico6(), obterDadosGrafico7()">
    <!--Menu-->
    <div class="header back-roxo">
        <div class="container">
            <a href="painelgeral.html"><img class="logo" src="img/logo_abstract.png" alt=""></a>
            <ul class="navbar">
                <li class="dropdownBttn"><a href="#">Gráficos</a>
                    <!-- <ul id="dropdownUl">
                        <li> <a href="#navbar_painel">Seus Resultados</a></li>
                        <li><a href="#ranking">Ranking Geral</a></li>
                        <li><a href="#impressionismo">Impressionismo</a></li>
                    </ul> -->
                </li>
                <li><a href="pesquisa.html">Responder Questionário</a></li>
                <li><a href="avaliacao.html">Avalie</a></li>
                <li><a href="index.html">Sair</a></li>
            </ul>
        </div>
    </div>
    <div class="divEspacoHeader"></div>
    <!--Conteudo-->
    <div id="painelGeral" class="titulo color-roxo">
        <span>Painel de Gráficos</span>
        <span>Olá, <b id="nome_usuario">Fulana</b></span>
    </div>
    <div id="navbar_painel">
        <a href="#navbar_painel" class="link-painel back-amarelo">Seus Resultados</a>
        <a href="#ranking" class="link-painel back-amarelo">Ranking Geral</a>
        <a href="#impressionismo" class="link-painel back-amarelo">Impressionismo</a>
    </div>

    <div id="resultados_usuario">
        <div class="titulo color-roxo">
            <span>Seus Resultados</span>
        </div>

        <div class="linha-graficos">
            <div id="lista_tentativas">
                <span>Resultado mais frequente: <b id="obra_frequente_usuario" class="color-amarelo">O Almoço dos
                        Barqueiros</b></span>
                <div class="linha"></div>
                <div class="linha-lista-tentativas" style="font-weight: bold;">
                    <span>Tentativas</span>
                    <span>Data</span>
                </div>
                <div id="tentativas_banco_dados">
                    <!-- puxar lista banco -->
                </div>
            </div>
            <div id="grafico_resultados_pizza">
                <!-- grafico pizza -->
                <span class="subtitulo">Resultado das Tentativas</span>
                <canvas id="myChart"></canvas>
            </div>
        </div>
        <div class="linha-graficos">
            <div id="graficos_tentativas_linha">
                <div>
                    <span class="subtitulo">Tentativas x Meses</span>
                    <canvas id="myChartsegundo"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div id="ranking">
        <div class="titulo color-roxo">
            <span>Ranking Geral</span>
        </div>
        <div class="linha-graficos">
            <div class="cards-kpis">
                <span>Resultado Mais <br> Recorrente</span>
                <h1 class="color-amarelo">
                    <!-- KPI -->
                    O Almoço dos Barqueiros
                </h1>
            </div>
            <div class="cards-kpis">
                <span>Artista Mais <br> Recorrente</span>
                <h1 class="color-amarelo">
                    <!-- KPI -->
                    Claude Monet
                </h1>
            </div>
            <div class="cards-kpis">
                <span>Idade Média <br> de Usuário</span>
                <h1 class="color-amarelo">
                    <!-- KPI -->
                    <span class="kpi-num">26</span>
                </h1>
            </div>
            <div class="cards-kpis">
                <span>Número Médio de Tentativas por Usuário</span>
                <h1>
                    <!-- KPI -->
                    <span class="kpi-num color-amarelo">4</span>
                </h1>
            </div>
        </div>

        <div class="linha-graficos" id="linha-ranking-2">
            <div id="grafico_resultados_pizza">
                <!-- grafico pizza -->
                <span class="subtitulo">Relação de Resultados</span>
                <canvas id="myChartterceiro"></canvas>
            </div>
            <div id="grafico_resultados_pizza">
                <!-- grafico pizza -->
                <span class="subtitulo">Relação de Artistas</span>
                <canvas id="myChartquarto"></canvas>
            </div>
            <div id="grafico_resultados_pizza">
                <!-- grafico pizza -->
                <span class="subtitulo">Hobbies dos Usuários</span>
                <canvas id="myChartquinto"></canvas>
            </div>
        </div>
        <div class="linha-graficos" id="linha-ranking-2">
            <div id="grafico_resultados_pizza">
                <!-- grafico pizza -->
                <span class="subtitulo">Características dos Usuários</span>
                <canvas id="myChartsexto"></canvas>
            </div>
            <div id="grafico_resultados_barra">
                <!-- grafico pizza -->
                <span class="subtitulo">Meses x Resultados</span>
                <canvas id="myChartsetimo"></canvas>
            </div>

        </div>
    </div>
    </div>
    <div id="impressionismo">
        <div class="titulo color-roxo">
            <span>Movimento Impressionista</span>
        </div>
        <div class="bloco-graficos">
            <div class="coluna-graficos">
                <div class="cards-kpis-impressionismo">
                    <span>Artista Com Maior <br> Acervo</span>
                    <h1 class="color-amarelo">
                        <!-- KPI -->
                        Edgar Degas
                    </h1>
                </div>
                <div class="cards-kpis-impressionismo">
                    <span>Total de Obras <br> Produzidas</span>
                    <h1 class="color-amarelo">
                        <!-- KPI -->
                        5.168
                    </h1>
                </div>
            </div>
            <div class="coluna-graficos">
                <div id="grafico_resultados_barra">
                    <span class="subtitulo">Artistas x Quantidade de Obras</span>
                    <canvas id="myChart8"></canvas>
                </div>
            </div>
        </div>

    </div>
    </div>



    <div id="rodape">
        <h1>Desenvolvido por Natália Russo</h1>
        <div class="conteudo-rodape">
            <div class="contato">
                <span class="subtitulo">Contato</span><br>
                <span>Telefone: (19) 99728-9318</span><br>
                <span>E-mail: abstract@contato.com</span><br>
                <span>Endereço: Rua Haddock Lobo, 595 - Cerqueira César</span><br>
                <span> São Paulo - SP, 01414-001</span>
                <div class="img-rodape">
                    <a href=""><img src="img/whatsapp.png" alt="WhatsApp"></a>
                    <a href=""><img src="img/instagram.png" alt="Instagram"></a>
                    <a href=""><img src="img/facebook.png" alt="Facebook"></a>
                    <a href=""><img src="img/linkedin.png" alt="LinkedIn"></a>
                </div>
            </div>
            <div class="paginas">
                <span class="subtitulo">Abstract.com.br</span><br>
                <span><a href="index.html">Home</a></span><br>
                <span><a href="saibamais.html">Saiba Mais</a></span><br>
                <span><a href="artistas.html">Artistas</a></span><br>
                <span><a href="faleconosco.html">Fale Conosco</a></span><br>
                <span><a href="sobrenos.html">Sobre Nós</a></span><br>
                <span><a href="login.html">Faça Login</a></span><br>
                <span><a href="cadastro.html">Cadastre-se</a></span><br>
            </div>
        </div>
    </div>
</body>

</html>
<script>
    nome_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    window.onload = obterDadosGrafico();
    window.onload = obterDadosGrafico2();
    window.onload = obterDadosGrafico3();
    window.onload = obterDadosGrafico4();
    window.onload = obterDadosGrafico5();
    window.onload = obterDadosGrafico6();
    window.onload = obterDadosGrafico7();


    // PUXANDO RESULTADOS ILUSTRATIVOS PARA A LISTA DE TENTATIVAS DO USUARIO
    function puxarTentativasBD() {
        var listaTentativasUsuario = [
            'O Almoço dos Barqueiros',
            'O Boulevard Montmartre, no fim da tarde',
            'O Almoço dos Barqueiros'
        ]

        var listaTentativasUsuarioData = [
            '02/05/2023',
            '02/05/2023',
            '04/05/2023'
        ]

        for (var contador = 0; contador < 3; contador++) {
            tentativas_banco_dados.innerHTML += `
       <div class="linha-lista-tentativas">
            <span>${listaTentativasUsuario[contador]}</span>
            <span>${listaTentativasUsuarioData[contador]}</span>
        </div>
    `
        }

    }
    puxarTentativasBD()


    // ------Primeiro Gráfico---------------------------------------------------------------------------------------------------------------------------------------------------------------

    function obterDadosGrafico(idUsuario) {

fetch(`/medidas/ultimas/${idUsuario}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico(resposta, idUsuario);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}
function plotarGrafico(resposta, idUsuario) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
let labels = [];

// Criando estrutura para plotar gráfico - dados
let dados = {
labels: labels,
datasets: [{
label: 'Resposta',
data: [],
fill: false,
backgroundColor: [
'#FFC531',
'rgba(255, 197, 49, 0.80)',
'rgba(255, 197, 49, 0.60)',
'rgba(255, 197, 49, 0.40)',
'rgba(255, 197, 49, 0.20)'
],
tension: 0.1
},
{
label: 'Resposta',
data: [],
fill: false,
borderColor: 'rgb(199, 52, 52)',
tension: 0.1
}]
};

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta)

// Inserindo valores recebidos em estrutura para plotar o gráfico
for (i = 0; i < resposta.length; i++) {
var registro = resposta[i];
labels.push(registro.resultado);
dados.datasets[0].data.push(registro.num);
}

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log(labels)
console.log('Dados:')
console.log(dados.datasets)
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config
const config = {
type: 'pie',
data: dados,
};

// Adicionando gráfico criado em div na tela
let myChart = new Chart(
document.getElementById('myChart'),
config
);


setTimeout(() => atualizarGrafico(idUsuario, dados, myChart), 2000);
}

function atualizarGrafico(idUsuario, dados, myChart) {



fetch(`/medidas/tempo-real/${idUsuario}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (novoRegistro) {

            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados);

            let avisoCaptura = document.getElementById(`avisoCaptura${idUsuario}`)
            // avisoCaptura.innerHTML = ""


            if (novoRegistro[0].momento_grafico == dados.labels[dados.labels.length]) {
                console.log("---------------------------------------------------------------")
                console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                console.log("Horário do novo dado capturado:")
                console.log(novoRegistro[0].resultado)
                console.log("Horário do último dado capturado:")
                console.log(dados.labels[dados.labels.length])
                console.log("---------------------------------------------------------------")
            } else {
                // tirando e colocando valores no gráfico
                dados.labels.shift(); // apagar o primeiro
                dados.labels.push(novoRegistro[0].resultado); // incluir um novo momento

                dados.datasets[0].data.shift();  // apagar o primeiro de umidade
                dados.datasets[0].data.push(novoRegistro[0].num); // incluir uma nova medida de umidade


                myChart.update();
            }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

}
    // ---------Segundo Gráfico------------------------------------------------------------------------------------------------------------------------------------------------------------
    function obterDadosGrafico2(idUsuario2) {

// alterarTitulo(idResposta)

// if (proximaAtualizacao != undefined) {
//     clearTimeout(proximaAtualizacao);
// // }

fetch(`/medidas/ultimas2/${idUsuario2}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: GRaIFCO 2 ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico2(resposta, idUsuario2);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}


function plotarGrafico2(resposta, idUsuario2) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
let labels = [];

// Criando estrutura para plotar gráfico - dados
let dados2 = {
labels: labels,
datasets: [{
label: 'Número de Tentativas',
data: [],
fill: false,
backgroundColor: [
'#5d91d4e3'
],
tension: 0.1
}]
};

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta)

// Inserindo valores recebidos em estrutura para plotar o gráfico
for (i2 = 0; i2 < resposta.length; i2++) {
var registro = resposta[i2];
labels.push(registro.mes);
dados2.datasets[0].data.push(registro.tentativas);
}

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log(labels)
console.log('Dados:')
console.log(dados2.datasets)
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config
const config = {
type: 'bar',
data: dados2,
};

// Adicionando gráfico criado em div na tela
let myChart2 = new Chart(
document.getElementById('myChartsegundo'),
config
);


setTimeout(() => atualizarGrafico2(idUsuario2, dados2, myChart2), 2000);
}

function atualizarGrafico2(idUsuario2, dados2, myChart2) {



fetch(`/medidas/tempo-real2/${idUsuario2}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (novoRegistro2) {

            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro2)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados2);

            // let avisoCaptura = document.getElementById(`avisoCaptura${idUsuario}`)
            // avisoCaptura.innerHTML = ""


            if (novoRegistro2[0].momento_grafico == dados2.labels[dados2.labels.length]) {
                console.log("---------------------------------------------------------------")
                console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                console.log("Horário do novo dado capturado:")
                console.log(novoRegistro2[0].tentativas)
                console.log("Horário do último dado capturado:")
                console.log(dados2.labels[dados2.labels.length])
                console.log("---------------------------------------------------------------")
            } else {
                // tirando e colocando valores no gráfico
                dados2.labels.shift(); // apagar o primeiro
                dados2.labels.push(novoRegistro2[0].mes); // incluir um novo momento

                dados2.datasets[0].data.shift();  // apagar o primeiro de umidade
                dados2.datasets[0].data.push(novoRegistro2[0].tentativas); // incluir uma nova medida de umidade


                myChart2.update();
            }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

}

    // ---------Terceiro Gráfico------------------------------------------------------------------------------------------------------------------------------------------------------------

    function obterDadosGrafico3(idUsuario3) {

// alterarTitulo(idResposta)

// if (proximaAtualizacao != undefined) {
//     clearTimeout(proximaAtualizacao);
// // }

fetch(`/medidas/ultimas3/${idUsuario3}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: GRaIFCO 3 ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico3(resposta, idUsuario3);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}

function plotarGrafico3(resposta, idUsuario3) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
let labels = [];

// Criando estrutura para plotar gráfico - dados
let dados3 = {
labels: labels,
datasets: [{
label: 'Resultados',
data: [],
fill: false,
backgroundColor: [
'#FFC531',
'rgba(255, 197, 49, 0.80)',
'rgba(255, 197, 49, 0.60)',
'rgba(255, 197, 49, 0.40)',
'rgba(255, 197, 49, 0.20)'
],
tension: 0.1
}]
};

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta)

// Inserindo valores recebidos em estrutura para plotar o gráfico
for (i3 = 0; i3 < resposta.length; i3++) {
var registro = resposta[i3];
labels.push(registro.resultado);
dados3.datasets[0].data.push(registro.num);
}

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log(labels)
console.log('Dados:')
console.log(dados3.datasets)
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config
const config = {
type: 'pie',
data: dados3,
};

// Adicionando gráfico criado em div na tela
let myChart3 = new Chart(
document.getElementById('myChartterceiro'),
config
);


setTimeout(() => atualizarGrafico3(idUsuario3, dados3, myChart3), 2000);
}

function atualizarGrafico3(idUsuario3, dados3, myChart3) {



fetch(`/medidas/tempo-real3/${idUsuario3}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (novoRegistro3) {

            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro3)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados3);

            // let avisoCaptura = document.getElementById(`avisoCaptura${idUsuario}`)
            // avisoCaptura.innerHTML = ""


            if (novoRegistro3[0].momento_grafico == dados3.labels[dados3.labels.length]) {
                console.log("---------------------------------------------------------------")
                console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                console.log("Horário do novo dado capturado:")
                console.log(novoRegistro3[0].num)
                console.log("Horário do último dado capturado:")
                console.log(dados3.labels[dados3.labels.length])
                console.log("---------------------------------------------------------------")
            } else {
                // tirando e colocando valores no gráfico
                dados3.labels.shift(); // apagar o primeiro
                dados3.labels.push(novoRegistro3[0].resultado); // incluir um novo momento

                dados3.datasets[0].data.shift();  // apagar o primeiro de umidade
                dados3.datasets[0].data.push(novoRegistro3[0].num); // incluir uma nova medida de umidade


                myChart3.update();
            }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

}

//----Quarto Gráfico----------------------------------------------------------------------------------------------------------------------

    function obterDadosGrafico4(idUsuario4) {

fetch(`/medidas/ultimas4/${idUsuario4}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: GRaIFCO 4 ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico4(resposta, idUsuario4);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}

function plotarGrafico4(resposta, idUsuario4) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
let labels = [];

// Criando estrutura para plotar gráfico - dados
let dados4 = {
labels: labels,
datasets: [{
label: 'Resultados',
data: [],
fill: false,
backgroundColor: [
'rgba(93, 145, 212)',
'rgba(93, 145, 212, 0.80)',
'rgba(93, 145, 212, 0.60)',
'rgba(93, 145, 212, 0.40)',
'rgba(93, 145, 212, 0.20)'
],
tension: 0.1
}]
};

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta)

// Inserindo valores recebidos em estrutura para plotar o gráfico
for (i3 = 0; i3 < resposta.length; i3++) {
var registro = resposta[i3];
labels.push(registro.artista);
dados4.datasets[0].data.push(registro.num);
}

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log(labels)
console.log('Dados:')
console.log(dados4.datasets)
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config
const config = {
type: 'pie',
data: dados4,
};

// Adicionando gráfico criado em div na tela
let myChart4 = new Chart(
document.getElementById('myChartquarto'),
config
);


setTimeout(() => atualizarGrafico4(idUsuario4, dados4, myChart4), 2000);
}

function atualizarGrafico4(idUsuario4, dados4, myChart4) {



fetch(`/medidas/tempo-real4/${idUsuario4}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (novoRegistro4) {

            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro4)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados4);

            // let avisoCaptura = document.getElementById(`avisoCaptura${idUsuario}`)
            // avisoCaptura.innerHTML = ""


            if (novoRegistro4[0].momento_grafico == dados4.labels[dados4.labels.length]) {
                console.log("---------------------------------------------------------------")
                console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                console.log("Horário do novo dado capturado:")
                console.log(novoRegistro4[0].num)
                console.log("Horário do último dado capturado:")
                console.log(dados4.labels[dados4.labels.length])
                console.log("---------------------------------------------------------------")
            } else {
                // tirando e colocando valores no gráfico
                dados4.labels.shift(); // apagar o primeiro
                dados4.labels.push(novoRegistro4[0].artista); // incluir um novo momento

                dados4.datasets[0].data.shift();  // apagar o primeiro de umidade
                dados4.datasets[0].data.push(novoRegistro4[0].num); // incluir uma nova medida de umidade


                myChart4.update();
            }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

}
// ------------Quinto Gráfico ----------------------------------------------------------------------------------------------------------------------

    function obterDadosGrafico5(idUsuario5) {


fetch(`/medidas/ultimas5/${idUsuario5}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: GRaIFCO 5 ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico5(resposta, idUsuario5);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}


function plotarGrafico5(resposta, idUsuario5) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
let labels = [];

// Criando estrutura para plotar gráfico - dados
let dados5 = {
labels: labels,
datasets: [{
label: 'Resultados',
data: [],
fill: false,
backgroundColor: [
'#FFC531',
'rgba(255, 197, 49, 0.80)',
'rgba(255, 197, 49, 0.60)',
'rgba(255, 197, 49, 0.40)',
'rgba(255, 197, 49, 0.20)'
],
tension: 0.1
}]
};

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta)

// Inserindo valores recebidos em estrutura para plotar o gráfico
for (i3 = 0; i3 < resposta.length; i3++) {
var registro = resposta[i3];
labels.push(registro.questao4);
dados5.datasets[0].data.push(registro.num);
}

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log(labels)
console.log('Dados:')
console.log(dados5.datasets)
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config
const config = {
type: 'pie',
data: dados5,
};

// Adicionando gráfico criado em div na tela
let myChart5 = new Chart(
document.getElementById('myChartquinto'),
config
);


setTimeout(() => atualizarGrafico5(idUsuario5, dados5, myChart5), 2000);
}

function atualizarGrafico5(idUsuario5, dados5, myChart5) {



fetch(`/medidas/tempo-real5/${idUsuario5}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (novoRegistro5) {

            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro5)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados5);

            // let avisoCaptura = document.getElementById(`avisoCaptura${idUsuario}`)
            // avisoCaptura.innerHTML = ""


            if (novoRegistro5[0].momento_grafico == dados5.labels[dados5.labels.length]) {
                console.log("---------------------------------------------------------------")
                console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                console.log("Horário do novo dado capturado:")
                console.log(novoRegistro5[0].num)
                console.log("Horário do último dado capturado:")
                console.log(dados5.labels[dados5.labels.length])
                console.log("---------------------------------------------------------------")
            } else {
                // tirando e colocando valores no gráfico
                dados5.labels.shift(); // apagar o primeiro
                dados5.labels.push(novoRegistro5[0].questao4); // incluir um novo momento

                dados5.datasets[0].data.shift();  // apagar o primeiro de umidade
                dados5.datasets[0].data.push(novoRegistro5[0].num); // incluir uma nova medida de umidade


                myChart5.update();
            }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

}


// -------------Sexto Gráfico-------------------------------------------------------------------------------------------------------------------------------

    function obterDadosGrafico6(idUsuario6) {


fetch(`/medidas/ultimas6/${idUsuario6}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: GRaIFCO 6 ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico6(resposta, idUsuario6);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}


function plotarGrafico6(resposta, idUsuario6) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
let labels = [];

// Criando estrutura para plotar gráfico - dados
let dados6 = {
labels: labels,
datasets: [{
label: 'Resultados',
data: [],
fill: false,
backgroundColor: [
'rgba(93, 145, 212)',
'rgba(93, 145, 212, 0.80)',
'rgba(93, 145, 212, 0.60)',
'rgba(93, 145, 212, 0.40)',
'rgba(93, 145, 212, 0.20)'
],
tension: 0.1
}]
};

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta)

// Inserindo valores recebidos em estrutura para plotar o gráfico
for (i3 = 0; i3 < resposta.length; i3++) {
var registro = resposta[i3];
labels.push(registro.questao3);
dados6.datasets[0].data.push(registro.num);
}

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log(labels)
console.log('Dados:')
console.log(dados6.datasets)
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config
const config = {
type: 'pie',
data: dados6,
};

// Adicionando gráfico criado em div na tela
let myChart6 = new Chart(
document.getElementById('myChartsexto'),
config
);


setTimeout(() => atualizarGrafico6(idUsuario6, dados6, myChart6), 2000);
}

function atualizarGrafico6(idUsuario6, dados6, myChart6) {



fetch(`/medidas/tempo-real6/${idUsuario6}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (novoRegistro6) {

            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro6)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados6);

            // let avisoCaptura = document.getElementById(`avisoCaptura${idUsuario}`)
            // avisoCaptura.innerHTML = ""


            if (novoRegistro6[0].momento_grafico == dados6.labels[dados6.labels.length]) {
                console.log("---------------------------------------------------------------")
                console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                console.log("Horário do novo dado capturado:")
                console.log(novoRegistro6[0].num)
                console.log("Horário do último dado capturado:")
                console.log(dados6.labels[dados6.labels.length])
                console.log("---------------------------------------------------------------")
            } else {
                // tirando e colocando valores no gráfico
                dados6.labels.shift(); // apagar o primeiro
                dados6.labels.push(novoRegistro6[0].questao3); // incluir um novo momento

                dados6.datasets[0].data.shift();  // apagar o primeiro de umidade
                dados6.datasets[0].data.push(novoRegistro6[0].num); // incluir uma nova medida de umidade


                myChart6.update();
            }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

}

// ---------Sétimo Gráfico------------------------------------------------------------------------------------------------------------------------------

    function obterDadosGrafico7(idUsuario7) {


fetch(`/medidas/ultimas7/${idUsuario7}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: GRaIFCO 7 ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico7(resposta, idUsuario7);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}


function plotarGrafico7(resposta, idUsuario7) {

console.log('iniciando plotagem do gráfico...');

// Criando estrutura para plotar gráfico - labels
let labels = [];

// Criando estrutura para plotar gráfico - dados
let dados7 = {
labels: labels,
datasets: [{
label: 'Número de Tentativas',
data: [],
fill: false,
backgroundColor: [
'#FFC531'
],
tension: 0.1
}]
};

console.log('----------------------------------------------')
console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
console.log(resposta)

// Inserindo valores recebidos em estrutura para plotar o gráfico
for (i3 = 0; i3 < resposta.length; i3++) {
var registro = resposta[i3];
labels.push(registro.mes);
dados7.datasets[0].data.push(registro.num);
}

console.log('----------------------------------------------')
console.log('O gráfico será plotado com os respectivos valores:')
console.log('Labels:')
console.log(labels)
console.log('Dados:')
console.log(dados7.datasets)
console.log('----------------------------------------------')

// Criando estrutura para plotar gráfico - config
const config = {
type: 'line',
data: dados7,
};

// Adicionando gráfico criado em div na tela
let myChart7 = new Chart(
document.getElementById('myChartsetimo'),
config
);


setTimeout(() => atualizarGrafico7(idUsuario7, dados7, myChart7), 2000);
}

function atualizarGrafico7(idUsuario7, dados7, myChart7) {



fetch(`/medidas/tempo-real7/${idUsuario7}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (novoRegistro7) {

            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro7)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados7);

            // let avisoCaptura = document.getElementById(`avisoCaptura${idUsuario}`)
            // avisoCaptura.innerHTML = ""


            if (novoRegistro7[0].momento_grafico == dados7.labels[dados7.labels.length]) {
                console.log("---------------------------------------------------------------")
                console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                console.log("Horário do novo dado capturado:")
                console.log(novoRegistro7[0].num)
                console.log("Horário do último dado capturado:")
                console.log(dados7.labels[dados7.labels.length])
                console.log("---------------------------------------------------------------")
            } else {
                // tirando e colocando valores no gráfico
                dados7.labels.shift(); // apagar o primeiro
                dados7.labels.push(novoRegistro7[0].mes); // incluir um novo momento

                dados7.datasets[0].data.shift();  // apagar o primeiro de umidade
                dados7.datasets[0].data.push(novoRegistro7[0].num); // incluir uma nova medida de umidade


                myChart7.update();
            }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        // proximaAtualizacao = setTimeout(() => atualizarGrafico(idResposta, dados, myChart), 2000);
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

}

// ---------OITAVO Gráfico ESTATICO------------------------------------------------------------------------------------------------------------------------------

    const ctx8 = document.getElementById('myChart8');

    new Chart(ctx8, {
        type: 'bar',
        data: {
            labels: [
                'Claude Monet',
                'Pierre-August Renoir',
                'Camile Pissaro',
                'Edgar Degas'
            ],
            datasets: [{
                label: 'Quantidade de Obras Produzidas',
                data: [1367, 1412, 889, 1500],
                backgroundColor: [
                    '#FFC531',
                ],
                hoverOffset: 4
            }]
        }
    });


    
</script>